%\documentclass[a4paper,11pt]{article}
%%\usepackage{ulem}
%%\usepackage{a4wide}
%%\usepackage[dvipsnames,svgnames]{xcolor}
%%\usepackage[pdftex]{graphicx}
%%\title{PTC\_EPLACEMENT}
%%\usepackage{hyperref}
% commands generated by html2latex


%%\begin{document}
%%\begin{center}
   %%EUROPEAN ORGANIZATION FOR NUCLEAR RESEARCH   
%%\includegraphics{http://cern.ch/madx/icons/mx7_25.gif}

\section{PTC\_EPLACEMENT}
%%\end{center}
%   ##########################################################              

%   ##########################################################              

%   ##########################################################              

%   ##########################################################              


\subsubsection{   USER MANUAL   }
%   ##########################################################              


\paragraph{SYNOPSIS}
\begin{verbatim}

PTC_EPLACEMENT, 
range = [s, none],
x        = [r, 0], y       = [r, 0], z       = [r, 0],
phi      = [r, 0],
theta   = [r, 0], 
onlyposition    = [l, false, true] ,
onlyorientation = [l, false, true] ,
autoplacedownstream = [l, true, true] ,
refframe = [s, gcs] ; 

\end{verbatim}
%   ##########################################################              


\textbf{ Description }\\

 Places a given element at required position and orientation.  All rotations are made around the front face of the element. \\

\textbf{ Example }\\

\href{http://cern.ch/frs/mad-X_examples/ptc_madx_interface/eplacement/chicane.madx}{  Dog leg chicane } : postion of quads is matched to obtain required R566 value.  
%   ##########################################################              


\paragraph{ Command parameters and switches }
\begin{description}
	\item[\textbf{ range }] \textit{ string in range format, }

 Specifies name of the element to be moved.   
	\item[\textbf{ x,y,z }] \textit{ real,   }

Coordinate of the front face of the magnet.   
	\item[\textbf{ phi, theta }] \textit{ real,   }

 polar (in xz plane, around z axis) and azimuthal (around x axis) angles, respectively.   
	\item[\textbf{ refframe }] \textit{ string, default gcs}

 Defines the coordinate system with respect to which coordinates and angles are specified.       Possible values are:       
\begin{description}
	\item[gcs ]  global coordinate system 
	\item[current ]   current position
	\item[previouselement ]  end face of the previous element 
\end{description}
	\item[\textbf{ onlyposition }] \textit{ logical, default false, if value explicitly not specified then true}

 If true, only translation are performed and orientation of the element is not changed.   
	\item[\textbf{ onlyorientation }] \textit{ logical, default false, if value explicitly not specified then true}

 If true, only rotations are performed and position of the element is not changed.   
	\item[\textbf{ autoplacedownstream }] \textit{ logical, default true,    }

 if true all the elements downstream are placed at default positions in respect to the        moved element, if false the rest of the layout stays untouched.   
	\item[\textbf{ surveyall }] \textit{ logical, default true, if value explicitly not specified then true}

 If true, survey of all the line is performed after element placement at new position       and orientation. It is implemented mainly for the software debugging purposes.        If patching was performed correctly, the global survey should not change anything.   
\end{description}

\paragraph{\_  }
%  ############################################################ 

%  ############################################################ 

%  ############################################################ 


\subsubsection{ PROGRAMMERS MANUAL }

  The command is implemented pro\_ptc\_eplacement function in madxn.c and  by subroutine ptc\_eplacement() in madx\_ptc\_eplacement.f90. 

 Sopecified range is resolved with help of get\_range command. Number of the element in the current sequence is resolved and passed as the parameter to the fortran routine. It allows to resolve uniquely the corresponding element in the PTC layout. 

 TRANSLATE\_Fibre and ROTATE\_Fibre routines of ptc are employed to place and orient an element in space. These commands adds rotation and translation from the current position. Hence, if the specified reference frame is other then "current", the element firstly needs to be placed at the center of the reference frame and then it is moved about the user specified coordinates.  

 After element placement at new position and orientation patch needs to be recomputed. If autoplacedownstream is false then patch to the next element is also recomputed. Otherwise, the layout is surveyed from the next element on, what places all the elements downstream with default position with respect to the moved element. 

 At the end all the layout is surveyed, if surveyall flag is true, what normally should always take place.     

%%\end{document}
