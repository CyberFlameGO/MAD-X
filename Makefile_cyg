# |
# o---------------------------------------------------------------------o
# |
# | MAD makefile - post-makefile Cygwin customization
# |
# o---------------------------------------------------------------------o
# |
# | Methodical Accelerator Design
# |
# | Copyright (c) 2011+ CERN, mad@cern.ch
# |
# | For more information, see http://cern.ch/mad
# |
# o---------------------------------------------------------------------o
# |
# | $Id$
# |

#
# all
#
all-win:  madx-win numdiff-win

#
# madx
#
madx-win: madx-win32.exe

madx-win%: MAKE_ARGS = PRJNAME=$@ DESTDIR=$(DESTDIR) ONLINE=no STATIC=yes APPENDLD=yes
madx-win%: MAKE_OPTS = -j9 $(MAKEFLAGS) $(MAKEOVERRIDES)
madx-win%: MAKE_LINK = $(if $(DESTDIR),$(CP) $(DESTDIR)$@ $@ &&,) $(CP) $@

madx-win32.exe:
	$E "*** Building $@"
	$_ $(MAKE) $(MAKE_ARGS) $(MAKE_OPTS) ARCH=32 GNU=yes && $(MAKE_LINK) madx32.exe

#
# numdiff
#
numdiff-win:  numdiff-win32.exe

numdiff-win%: DESTDIR  := $(DESTDIR)tools$/numdiff
numdiff-win%: MAKE_ARGS = PRJNAME=$@ DESTDIR=..$/..$/$(DESTDIR) APPENDLD=yes
numdiff-win%: MAKE_OPTS = -j9 --no-print-directory -C tools/numdiff $(MAKEFLAGS) $(MAKEOVERRIDES)
numdiff-win%: MAKE_LINK = $(if $(DESTDIR),$(CP) $(DESTDIR)$/$@ $@ &&,) $(CP) $@

numdiff-win32.exe:
	$E "*** Building $@"
	$_ $(MAKE) $(MAKE_ARGS) $(MAKE_OPTS) ARCH=32 GNU=yes && $(MAKE_LINK) numdiff32.exe

